{"ast":null,"code":"var _jsxFileName = \"/home/gm/UBIQUM/projects/ubiqum-bootcamp/staff/genis-mestres/course-3/proyecto3/src/utilities/firebase.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\n// Import the functions you need from the SDKs you need\nimport { initializeApp } from 'firebase/app';\nimport { getAuth, GoogleAuthProvider, onIdTokenChanged, signInWithPopup, signOut } from 'firebase/auth';\nimport { useState, useEffect } from 'react';\nimport { getDatabase, onValue, ref, set } from \"firebase/database\"; // TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n// Your web app's Firebase configuration\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyAVxN35gSdmX2Ih_dUSCfCr74u0-R-l7O4\",\n  authDomain: \"project-iii-bf1a8.firebaseapp.com\",\n  databaseURL: \"https://project-iii-bf1a8-default-rtdb.europe-west1.firebasedatabase.app\",\n  projectId: \"project-iii-bf1a8\",\n  storageBucket: \"project-iii-bf1a8.appspot.com\",\n  messagingSenderId: \"156972537003\",\n  appId: \"1:156972537003:web:608ef8a18a7a6e0db753ee\"\n}; // Initialize Firebase and obtain its database \n\nconst app = initializeApp(firebaseConfig);\nconst database = getDatabase(app); //-------------------------------------------------\n\nconst path = '/messages';\n\nconst useData = (path, transform) => {\n  _s();\n\n  const [data, setData] = useState(); //Neither of the above is true. Your app should display what's in data.\n\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState();\n  console.log(\"is there a loop in useData?\");\n  useEffect(() => {\n    //refernce to a database, but not its data.d path refers to some part of your JSON object\n    const dbRef = ref(database, path);\n    /*? qué es devMOde ? permet gestionar la teva base de dades  temps real a traves de Node.js\r\n    production = quan els usuaris la poden utilitzar\r\n    development = quan encara s'hi està treballant i no està preparada per ser llançada al públic.\r\n    */\n\n    const devMode = !process.env.NODE_ENV || process.env.NODE_ENV === 'development';\n\n    if (devMode) {\n      console.log(`loading ${path}`);\n    }\n    /*the function will be sent a snapshot object. \r\n    The val() method of this object will contain the new data.\r\n    This is the primary way to read data from a Database. Your callback will be triggered for the initial data and again whenever the data changes. Invoke the returned unsubscribe callback to stop receiving updates */\n\n\n    return onValue(dbRef, snapshot => {\n      const val = snapshot.val(); //cuando el schedule times ha cambiado, se actualiza el valor\n\n      if (devMode) {\n        console.log(val);\n      }\n\n      setData(transform ? transform(val) : val);\n      setLoading(false);\n      setError(null);\n    }, error => {\n      setData(null);\n      setLoading(false);\n      setError(error);\n    });\n  }, [path, transform]); //el código se actualiza cuando path y transform canvian. \n\n  return [data, loading, error];\n};\n/*\r\n\r\n//ref(database, /messages)\r\n\r\n//const chat_game_id =`game-${id}`;\r\n\r\n  const chat_game_id =game-1\";\r\n\r\nfunction chat() {\r\n  const {gameChat, setGameChat}  = useState({});\r\n\r\n  useEffect( () => {\r\n    database.collection('messages').onSnapShot(snapshot => (\r\n      setGameChat(snapshot.docs.map(doc => doc.data())\r\n        )))\r\n  }, [])\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n*/\n//the authentication  in the database\n\n\n_s(useData, \"NHGwgwF0D09hI9K12vQBrfPMsF4=\");\n\nconst auth = getAuth(app);\nconst user = auth.currentUser; // the authentication provide in this case is Google, but could had been facebook\n\nconst provider = new GoogleAuthProvider(); //sign in function \n\nconst signInWithGoogle = () => {\n  console.log(\"signInWithGoogle\");\n  signInWithPopup(getAuth(app), new GoogleAuthProvider());\n}; //sign out  function\n\n\nconst signOutWithGoogle = () => {\n  console.log(\"sign OUT WithGoogle\");\n  signOut(getAuth(app));\n}; //---------------------------\n\n/*  onIdTokenChanged Adds an observer for changes to the signed-in user's ID token, which includes sign-in, sign-out, and token refresh events. This method has the same behavior as */\n// it tells if the current user is authenticated or not-----------------\n\n\nconst useUserState = () => {\n  _s2();\n\n  const [user, setUser] = useState(); //useEffect:  []  If an empty list is given, then React runs the function only when the component is first added.\n\n  useEffect(() => {\n    onIdTokenChanged(getAuth(app), setUser);\n  });\n  return [user];\n}; //----------Buttons--------------------------------------------------------------------\n\n\n_s2(useUserState, \"hT6C72rcbfRUedrDq+TPaFfRI/M=\");\n\nconst SignInButton = () => {\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    className: \"btn btn-light btn-outline-dark\",\n    onClick: signInWithGoogle,\n    children: \"Sign in\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 161,\n    columnNumber: 11\n  }, this);\n};\n\n_c = SignInButton;\n\nconst SignOutButton = () => {\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    className: \"btn btn-light btn-outline-secondary\",\n    onClick: signOutWithGoogle,\n    children: \"Sign Out\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 165,\n    columnNumber: 15\n  }, this);\n};\n/*  firebase.auth.GoogleAuthProvider -- this object holds information needed to use Google as a provider\r\n    firebase.auth().signInWithPopup(provider) - this function, given a provider object, pops up a dialog box to let a user sign in with that provider.\r\n    firebase.auth().signOut() -- this function signs the user out.\r\n    Note that some things are under firebase.auth and some are under the object returned by calling firebase.auth().\r\n    \r\n    signInWithGoogle \r\n    Calling this should cause a pop-up dialog box to appear asking the user to sign in with Google.\r\n    When the user finishes this, an authentication state change will occur and your code will be able to get the user information.\r\n    signOut\r\n    Calling this should sign out, i.e., the authentication state should change, and the user should become null.\r\n\r\n\r\n    */\n//-----------------------------------------\n\n\n_c2 = SignOutButton;\n\nfunction writeChat(game_num, message_num, message_author, message_text, message_timestamp) {\n  const db = database;\n  set(ref(db, 'messages/' + game_num + message_num), {\n    author: message_author,\n    text: message_text,\n    timestapm: message_timestamp\n  });\n}\n\nexport { useUserState, SignInButton, SignOutButton, database };\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"SignInButton\");\n$RefreshReg$(_c2, \"SignOutButton\");","map":{"version":3,"sources":["/home/gm/UBIQUM/projects/ubiqum-bootcamp/staff/genis-mestres/course-3/proyecto3/src/utilities/firebase.js"],"names":["initializeApp","getAuth","GoogleAuthProvider","onIdTokenChanged","signInWithPopup","signOut","useState","useEffect","getDatabase","onValue","ref","set","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","app","database","path","useData","transform","data","setData","loading","setLoading","error","setError","console","log","dbRef","devMode","process","env","NODE_ENV","snapshot","val","auth","user","currentUser","provider","signInWithGoogle","signOutWithGoogle","useUserState","setUser","SignInButton","SignOutButton","writeChat","game_num","message_num","message_author","message_text","message_timestamp","db","author","text","timestapm"],"mappings":"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","sourcesContent":["// Import the functions you need from the SDKs you need\r\n\r\nimport { initializeApp } from 'firebase/app';\r\nimport { getAuth, GoogleAuthProvider, onIdTokenChanged, signInWithPopup, signOut } from 'firebase/auth';\r\nimport { useState, useEffect } from 'react';\r\n\r\nimport { getDatabase, onValue, ref, set } from \"firebase/database\";\r\n\r\n\r\n// TODO: Add SDKs for Firebase products that you want to use\r\n// https://firebase.google.com/docs/web/setup#available-libraries\r\n// Your web app's Firebase configuration\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyAVxN35gSdmX2Ih_dUSCfCr74u0-R-l7O4\",\r\n  authDomain: \"project-iii-bf1a8.firebaseapp.com\",\r\n  databaseURL: \"https://project-iii-bf1a8-default-rtdb.europe-west1.firebasedatabase.app\",\r\n  projectId: \"project-iii-bf1a8\",\r\n  storageBucket: \"project-iii-bf1a8.appspot.com\",\r\n  messagingSenderId: \"156972537003\",\r\n  appId: \"1:156972537003:web:608ef8a18a7a6e0db753ee\"\r\n\r\n};\r\n\r\n\r\n// Initialize Firebase and obtain its database \r\n\r\nconst app = initializeApp(firebaseConfig);\r\nconst database = getDatabase(app);\r\n//-------------------------------------------------\r\nconst path = '/messages'\r\n\r\n\r\n\r\n\r\nconst useData = (path, transform) => {\r\n  const [data, setData] = useState();//Neither of the above is true. Your app should display what's in data.\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState();\r\nconsole.log(\"is there a loop in useData?\");\r\n          useEffect(() => {\r\n            //refernce to a database, but not its data.d path refers to some part of your JSON object\r\n              const dbRef = ref(database, path);\r\n\r\n              /*? qué es devMOde ? permet gestionar la teva base de dades  temps real a traves de Node.js\r\n              production = quan els usuaris la poden utilitzar\r\n              development = quan encara s'hi està treballant i no està preparada per ser llançada al públic.\r\n              */\r\n              const devMode = !process.env.NODE_ENV || process.env.NODE_ENV === 'development';\r\n              if (devMode) { console.log(`loading ${path}`); }\r\n\r\n              /*the function will be sent a snapshot object. \r\n              The val() method of this object will contain the new data.\r\n              This is the primary way to read data from a Database. Your callback will be triggered for the initial data and again whenever the data changes. Invoke the returned unsubscribe callback to stop receiving updates */\r\n              return onValue(dbRef, (snapshot) => {\r\n\r\n              const val = snapshot.val();\r\n              //cuando el schedule times ha cambiado, se actualiza el valor\r\n              if (devMode) { console.log(val); }\r\n                setData(transform ? transform(val) : val);\r\n                setLoading(false);\r\n                setError(null);\r\n              }, (error) => {\r\n                setData(null);\r\n                setLoading(false);\r\n                setError(error);\r\n              });\r\n          }, [path, transform]); //el código se actualiza cuando path y transform canvian. \r\n          \r\n      return [data, loading, error];\r\n  };\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/*\r\n\r\n//ref(database, /messages)\r\n\r\n//const chat_game_id =`game-${id}`;\r\n\r\n  const chat_game_id =game-1\";\r\n\r\nfunction chat() {\r\n  const {gameChat, setGameChat}  = useState({});\r\n\r\n  useEffect( () => {\r\n    database.collection('messages').onSnapShot(snapshot => (\r\n      setGameChat(snapshot.docs.map(doc => doc.data())\r\n        )))\r\n  }, [])\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n*/\r\n\r\n//the authentication  in the database\r\nconst auth = getAuth(app);  \r\nconst user = auth.currentUser;\r\n // the authentication provide in this case is Google, but could had been facebook\r\nconst provider = new GoogleAuthProvider() ;\r\n//sign in function \r\n  const signInWithGoogle = () => {\r\n    console.log(\"signInWithGoogle\")\r\n  signInWithPopup(getAuth(app), new GoogleAuthProvider() )\r\n  };\r\n  \r\n //sign out  function\r\n  const signOutWithGoogle = () => {\r\n    console.log(\"sign OUT WithGoogle\")\r\n   signOut(getAuth(app))\r\n  }\r\n\r\n \r\n  //---------------------------\r\n\r\n  /*  onIdTokenChanged Adds an observer for changes to the signed-in user's ID token, which includes sign-in, sign-out, and token refresh events. This method has the same behavior as */\r\n// it tells if the current user is authenticated or not-----------------\r\nconst useUserState = () => {\r\n \r\n  const [user, setUser] = useState();\r\n    //useEffect:  []  If an empty list is given, then React runs the function only when the component is first added.\r\n  useEffect(() => {\r\n    onIdTokenChanged(getAuth(app), setUser);\r\n\r\n  },);\r\n   return [user];\r\n};\r\n\r\n\r\n\r\n  \r\n//----------Buttons--------------------------------------------------------------------\r\n\r\n  const SignInButton = () => {\r\n  return (<button className=\"btn btn-light btn-outline-dark\" onClick={signInWithGoogle}>Sign in</button>)\r\n  }\r\n\r\n  const SignOutButton = () => {\r\n      return (<button className=\"btn btn-light btn-outline-secondary\" onClick={signOutWithGoogle}>Sign Out</button>)\r\n    }\r\n\r\n/*  firebase.auth.GoogleAuthProvider -- this object holds information needed to use Google as a provider\r\n    firebase.auth().signInWithPopup(provider) - this function, given a provider object, pops up a dialog box to let a user sign in with that provider.\r\n    firebase.auth().signOut() -- this function signs the user out.\r\n    Note that some things are under firebase.auth and some are under the object returned by calling firebase.auth().\r\n    \r\n    signInWithGoogle \r\n    Calling this should cause a pop-up dialog box to appear asking the user to sign in with Google.\r\n    When the user finishes this, an authentication state change will occur and your code will be able to get the user information.\r\n    signOut\r\n    Calling this should sign out, i.e., the authentication state should change, and the user should become null.\r\n\r\n\r\n    */\r\n\r\n   //-----------------------------------------\r\n   \r\n\r\n\r\n     \r\n   function writeChat(game_num, message_num, message_author, message_text, message_timestamp) {\r\n    const db = database;\r\n     set(ref(db, 'messages/' + game_num + message_num), {\r\n       author: message_author,\r\n       text: message_text,\r\n       timestapm : message_timestamp\r\n     });\r\n}\r\n\r\n\r\n\r\n\r\nexport {useUserState, SignInButton, SignOutButton, database}\r\n"]},"metadata":{},"sourceType":"module"}